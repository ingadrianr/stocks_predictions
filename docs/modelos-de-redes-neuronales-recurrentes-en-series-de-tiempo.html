<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>8 Modelos de Redes Neuronales Recurrentes en series de tiempo | Pronóstico De Índices Financieros</title>
  <meta name="description" content="8 Modelos de Redes Neuronales Recurrentes en series de tiempo | Pronóstico De Índices Financieros" />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="8 Modelos de Redes Neuronales Recurrentes en series de tiempo | Pronóstico De Índices Financieros" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="8 Modelos de Redes Neuronales Recurrentes en series de tiempo | Pronóstico De Índices Financieros" />
  
  
  

<meta name="author" content="Adrián Rodríguez Amaya &amp; Katherin Juliana Quiñones Losada" />


<meta name="date" content="2023-06-18" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="modelo-prophet.html"/>
<link rel="next" href="referencias.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Pronóstico De Índices Financieros</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Descargo De Responsabilidad</a></li>
<li class="chapter" data-level="1" data-path="introducción.html"><a href="introducción.html"><i class="fa fa-check"></i><b>1</b> Introducción</a></li>
<li class="chapter" data-level="2" data-path="definiciones.html"><a href="definiciones.html"><i class="fa fa-check"></i><b>2</b> Definiciones</a>
<ul>
<li class="chapter" data-level="2.1" data-path="definiciones.html"><a href="definiciones.html#sp-500-top-10"><i class="fa fa-check"></i><b>2.1</b> S&amp;P 500 Top 10</a></li>
<li class="chapter" data-level="2.2" data-path="definiciones.html"><a href="definiciones.html#cointegración"><i class="fa fa-check"></i><b>2.2</b> Cointegración</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="importación-de-los-datos.html"><a href="importación-de-los-datos.html"><i class="fa fa-check"></i><b>3</b> Importación de los datos</a></li>
<li class="chapter" data-level="4" data-path="análisis-exploratorio-de-datos.html"><a href="análisis-exploratorio-de-datos.html"><i class="fa fa-check"></i><b>4</b> Análisis Exploratorio de Datos</a>
<ul>
<li class="chapter" data-level="4.1" data-path="análisis-exploratorio-de-datos.html"><a href="análisis-exploratorio-de-datos.html#comportamiento-inicial-series"><i class="fa fa-check"></i><b>4.1</b> Comportamiento Inicial Series</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="análisis-exploratorio-de-datos.html"><a href="análisis-exploratorio-de-datos.html#promedio-móvil-y-rezagos"><i class="fa fa-check"></i><b>4.1.1</b> Promedio Móvil y Rezagos</a></li>
<li class="chapter" data-level="4.1.2" data-path="análisis-exploratorio-de-datos.html"><a href="análisis-exploratorio-de-datos.html#estacionalidad-descomposicion-aditiva"><i class="fa fa-check"></i><b>4.1.2</b> Estacionalidad (Descomposicion Aditiva)</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="análisis-exploratorio-de-datos.html"><a href="análisis-exploratorio-de-datos.html#estacionaridad"><i class="fa fa-check"></i><b>4.2</b> Estacionaridad</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="análisis-exploratorio-de-datos.html"><a href="análisis-exploratorio-de-datos.html#prueba-dickey--fuller-adf-series-naturales"><i class="fa fa-check"></i><b>4.2.1</b> Prueba Dickey- Fuller (ADF) Series naturales</a></li>
<li class="chapter" data-level="4.2.2" data-path="análisis-exploratorio-de-datos.html"><a href="análisis-exploratorio-de-datos.html#acf-y-pacf"><i class="fa fa-check"></i><b>4.2.2</b> ACF y PACF</a></li>
<li class="chapter" data-level="4.2.3" data-path="análisis-exploratorio-de-datos.html"><a href="análisis-exploratorio-de-datos.html#diferenciación"><i class="fa fa-check"></i><b>4.2.3</b> Diferenciación</a></li>
<li class="chapter" data-level="4.2.4" data-path="análisis-exploratorio-de-datos.html"><a href="análisis-exploratorio-de-datos.html#prueba-dickey--fuller-adf-series-diferenciadas"><i class="fa fa-check"></i><b>4.2.4</b> Prueba Dickey- Fuller (ADF) Series diferenciadas</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="métodos-de-suavizado.html"><a href="métodos-de-suavizado.html"><i class="fa fa-check"></i><b>5</b> Métodos de Suavizado</a>
<ul>
<li class="chapter" data-level="5.1" data-path="métodos-de-suavizado.html"><a href="métodos-de-suavizado.html#método-de-suavización-exponencial-simple"><i class="fa fa-check"></i><b>5.1</b> Método de Suavización Exponencial Simple</a></li>
<li class="chapter" data-level="5.2" data-path="métodos-de-suavizado.html"><a href="métodos-de-suavizado.html#metodo-de-holt-winters"><i class="fa fa-check"></i><b>5.2</b> Método de Holt-Winters</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="metodología-box-jenkins.html"><a href="metodología-box-jenkins.html"><i class="fa fa-check"></i><b>6</b> Metodología Box-jenkins</a>
<ul>
<li class="chapter" data-level="6.1" data-path="metodología-box-jenkins.html"><a href="metodología-box-jenkins.html#identificacion-del-modelo"><i class="fa fa-check"></i><b>6.1</b> Identificacion del modelo</a></li>
<li class="chapter" data-level="6.2" data-path="metodología-box-jenkins.html"><a href="metodología-box-jenkins.html#estimacion-del-modelo"><i class="fa fa-check"></i><b>6.2</b> Estimacion del modelo</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="modelo-prophet.html"><a href="modelo-prophet.html"><i class="fa fa-check"></i><b>7</b> Modelo Prophet</a></li>
<li class="chapter" data-level="8" data-path="modelos-de-redes-neuronales-recurrentes-en-series-de-tiempo.html"><a href="modelos-de-redes-neuronales-recurrentes-en-series-de-tiempo.html"><i class="fa fa-check"></i><b>8</b> Modelos de Redes Neuronales Recurrentes en series de tiempo</a>
<ul>
<li class="chapter" data-level="8.1" data-path="modelos-de-redes-neuronales-recurrentes-en-series-de-tiempo.html"><a href="modelos-de-redes-neuronales-recurrentes-en-series-de-tiempo.html#modelo-de-elman"><i class="fa fa-check"></i><b>8.1</b> Modelo de Elman</a></li>
<li class="chapter" data-level="8.2" data-path="modelos-de-redes-neuronales-recurrentes-en-series-de-tiempo.html"><a href="modelos-de-redes-neuronales-recurrentes-en-series-de-tiempo.html#modelo-de-jordan"><i class="fa fa-check"></i><b>8.2</b> Modelo de Jordan</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i><b>9</b> Referencias</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Pronóstico De Índices Financieros</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="modelos-de-redes-neuronales-recurrentes-en-series-de-tiempo" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number">8</span> Modelos de Redes Neuronales Recurrentes en series de tiempo<a href="modelos-de-redes-neuronales-recurrentes-en-series-de-tiempo.html#modelos-de-redes-neuronales-recurrentes-en-series-de-tiempo" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="modelo-de-elman" class="section level2 hasAnchor" number="8.1">
<h2><span class="header-section-number">8.1</span> Modelo de Elman<a href="modelos-de-redes-neuronales-recurrentes-en-series-de-tiempo.html#modelo-de-elman" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Las redes de Elman son el modelo más simple de Red Neuronal Recurrente (en adelante, RNN).Tienen la misma estructura que las redes neuronales alimentadas hacia adelante, salvo por una única circunstancia: se permite que cada neurona se retroalimente a sí misma.</p>
<p>A continuacion se realiza solo para APPLE:</p>
<p><img src="stocks-predictions_files/figure-html/08-2-1.png" width="672" /></p>
<p>Continuamos con la construccion de base de entrenamiento y base de test</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="modelos-de-redes-neuronales-recurrentes-en-series-de-tiempo.html#cb1-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>) </span>
<span id="cb1-2"><a href="modelos-de-redes-neuronales-recurrentes-en-series-de-tiempo.html#cb1-2" tabindex="-1"></a>tamano_total <span class="ot">&lt;-</span> <span class="fu">length</span>(stock_rnn_norm) </span>
<span id="cb1-3"><a href="modelos-de-redes-neuronales-recurrentes-en-series-de-tiempo.html#cb1-3" tabindex="-1"></a>tamano_train <span class="ot">&lt;-</span> <span class="fu">round</span>(tamano_total<span class="sc">*</span><span class="dv">9</span><span class="sc">/</span><span class="dv">12</span>, <span class="at">digits =</span> <span class="dv">0</span>) </span>
<span id="cb1-4"><a href="modelos-de-redes-neuronales-recurrentes-en-series-de-tiempo.html#cb1-4" tabindex="-1"></a>train <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span>(tamano_train<span class="dv">-1</span>) </span>
<span id="cb1-5"><a href="modelos-de-redes-neuronales-recurrentes-en-series-de-tiempo.html#cb1-5" tabindex="-1"></a>test<span class="ot">&lt;-</span>(tamano_train)<span class="sc">:</span>tamano_total</span>
<span id="cb1-6"><a href="modelos-de-redes-neuronales-recurrentes-en-series-de-tiempo.html#cb1-6" tabindex="-1"></a></span>
<span id="cb1-7"><a href="modelos-de-redes-neuronales-recurrentes-en-series-de-tiempo.html#cb1-7" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">as.zoo</span>(stock_rnn_norm)</span>
<span id="cb1-8"><a href="modelos-de-redes-neuronales-recurrentes-en-series-de-tiempo.html#cb1-8" tabindex="-1"></a></span>
<span id="cb1-9"><a href="modelos-de-redes-neuronales-recurrentes-en-series-de-tiempo.html#cb1-9" tabindex="-1"></a>x1<span class="ot">&lt;-</span><span class="fu">Lag</span>(y,<span class="at">k=</span><span class="dv">1</span>)</span>
<span id="cb1-10"><a href="modelos-de-redes-neuronales-recurrentes-en-series-de-tiempo.html#cb1-10" tabindex="-1"></a>x2<span class="ot">&lt;-</span><span class="fu">Lag</span>(y,<span class="at">k=</span><span class="dv">2</span>)</span>
<span id="cb1-11"><a href="modelos-de-redes-neuronales-recurrentes-en-series-de-tiempo.html#cb1-11" tabindex="-1"></a>x3<span class="ot">&lt;-</span><span class="fu">Lag</span>(y,<span class="at">k=</span><span class="dv">3</span>)</span>
<span id="cb1-12"><a href="modelos-de-redes-neuronales-recurrentes-en-series-de-tiempo.html#cb1-12" tabindex="-1"></a>x4<span class="ot">&lt;-</span><span class="fu">Lag</span>(y,<span class="at">k=</span><span class="dv">4</span>)</span>
<span id="cb1-13"><a href="modelos-de-redes-neuronales-recurrentes-en-series-de-tiempo.html#cb1-13" tabindex="-1"></a>x5<span class="ot">&lt;-</span><span class="fu">Lag</span>(y,<span class="at">k=</span><span class="dv">5</span>)</span>
<span id="cb1-14"><a href="modelos-de-redes-neuronales-recurrentes-en-series-de-tiempo.html#cb1-14" tabindex="-1"></a>x6<span class="ot">&lt;-</span><span class="fu">Lag</span>(y,<span class="at">k=</span><span class="dv">6</span>)</span>
<span id="cb1-15"><a href="modelos-de-redes-neuronales-recurrentes-en-series-de-tiempo.html#cb1-15" tabindex="-1"></a>x7<span class="ot">&lt;-</span><span class="fu">Lag</span>(y,<span class="at">k=</span><span class="dv">7</span>)</span>
<span id="cb1-16"><a href="modelos-de-redes-neuronales-recurrentes-en-series-de-tiempo.html#cb1-16" tabindex="-1"></a>x8<span class="ot">&lt;-</span><span class="fu">Lag</span>(y,<span class="at">k=</span><span class="dv">8</span>)</span>
<span id="cb1-17"><a href="modelos-de-redes-neuronales-recurrentes-en-series-de-tiempo.html#cb1-17" tabindex="-1"></a>x9<span class="ot">&lt;-</span><span class="fu">Lag</span>(y,<span class="at">k=</span><span class="dv">9</span>)</span>
<span id="cb1-18"><a href="modelos-de-redes-neuronales-recurrentes-en-series-de-tiempo.html#cb1-18" tabindex="-1"></a>x10<span class="ot">&lt;-</span><span class="fu">Lag</span>(y,<span class="at">k=</span><span class="dv">10</span>)</span>
<span id="cb1-19"><a href="modelos-de-redes-neuronales-recurrentes-en-series-de-tiempo.html#cb1-19" tabindex="-1"></a>slogN<span class="ot">&lt;-</span><span class="fu">cbind</span>(y,x1,x2,x3,x4,x5,x6,x7,x8,x9,x10)</span>
<span id="cb1-20"><a href="modelos-de-redes-neuronales-recurrentes-en-series-de-tiempo.html#cb1-20" tabindex="-1"></a></span>
<span id="cb1-21"><a href="modelos-de-redes-neuronales-recurrentes-en-series-de-tiempo.html#cb1-21" tabindex="-1"></a>slogN<span class="ot">&lt;-</span>slogN[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>),]</span>
<span id="cb1-22"><a href="modelos-de-redes-neuronales-recurrentes-en-series-de-tiempo.html#cb1-22" tabindex="-1"></a></span>
<span id="cb1-23"><a href="modelos-de-redes-neuronales-recurrentes-en-series-de-tiempo.html#cb1-23" tabindex="-1"></a></span>
<span id="cb1-24"><a href="modelos-de-redes-neuronales-recurrentes-en-series-de-tiempo.html#cb1-24" tabindex="-1"></a>inputs<span class="ot">&lt;-</span>slogN[,<span class="dv">2</span><span class="sc">:</span><span class="dv">11</span>]</span>
<span id="cb1-25"><a href="modelos-de-redes-neuronales-recurrentes-en-series-de-tiempo.html#cb1-25" tabindex="-1"></a>outputs<span class="ot">&lt;-</span>slogN[,<span class="dv">1</span>]</span>
<span id="cb1-26"><a href="modelos-de-redes-neuronales-recurrentes-en-series-de-tiempo.html#cb1-26" tabindex="-1"></a></span>
<span id="cb1-27"><a href="modelos-de-redes-neuronales-recurrentes-en-series-de-tiempo.html#cb1-27" tabindex="-1"></a></span>
<span id="cb1-28"><a href="modelos-de-redes-neuronales-recurrentes-en-series-de-tiempo.html#cb1-28" tabindex="-1"></a>fit<span class="ot">&lt;-</span><span class="fu">elman</span>(inputs[train],</span>
<span id="cb1-29"><a href="modelos-de-redes-neuronales-recurrentes-en-series-de-tiempo.html#cb1-29" tabindex="-1"></a>           outputs[train],</span>
<span id="cb1-30"><a href="modelos-de-redes-neuronales-recurrentes-en-series-de-tiempo.html#cb1-30" tabindex="-1"></a>           <span class="at">size=</span><span class="fu">c</span>(<span class="dv">9</span>,<span class="dv">2</span>),</span>
<span id="cb1-31"><a href="modelos-de-redes-neuronales-recurrentes-en-series-de-tiempo.html#cb1-31" tabindex="-1"></a>           <span class="at">learnFuncParams=</span><span class="fu">c</span>(<span class="fl">0.1</span>),</span>
<span id="cb1-32"><a href="modelos-de-redes-neuronales-recurrentes-en-series-de-tiempo.html#cb1-32" tabindex="-1"></a>           <span class="at">maxit=</span><span class="dv">10000</span>)</span>
<span id="cb1-33"><a href="modelos-de-redes-neuronales-recurrentes-en-series-de-tiempo.html#cb1-33" tabindex="-1"></a></span>
<span id="cb1-34"><a href="modelos-de-redes-neuronales-recurrentes-en-series-de-tiempo.html#cb1-34" tabindex="-1"></a></span>
<span id="cb1-35"><a href="modelos-de-redes-neuronales-recurrentes-en-series-de-tiempo.html#cb1-35" tabindex="-1"></a><span class="fu">plotIterativeError</span>(fit,<span class="at">main =</span> <span class="st">&quot;Iterative Error for 9,2 Neuron elman Model&quot;</span>)</span></code></pre></div>
<p><img src="stocks-predictions_files/figure-html/08-3-1.png" width="672" /></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="modelos-de-redes-neuronales-recurrentes-en-series-de-tiempo.html#cb2-1" tabindex="-1"></a><span class="do">### Se desnormalizan los datos</span></span>
<span id="cb2-2"><a href="modelos-de-redes-neuronales-recurrentes-en-series-de-tiempo.html#cb2-2" tabindex="-1"></a>predictions<span class="ot">&lt;-</span><span class="fu">predict</span>(fit,inputs[<span class="sc">-</span>train])</span>
<span id="cb2-3"><a href="modelos-de-redes-neuronales-recurrentes-en-series-de-tiempo.html#cb2-3" tabindex="-1"></a>valuesPred <span class="ot">&lt;-</span> predictions<span class="sc">*</span>(<span class="fu">max</span>(stock_rnn)<span class="sc">-</span><span class="fu">min</span>(stock_rnn)) <span class="sc">+</span> <span class="fu">min</span>(stock_rnn) </span>
<span id="cb2-4"><a href="modelos-de-redes-neuronales-recurrentes-en-series-de-tiempo.html#cb2-4" tabindex="-1"></a>valuesPred[<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>]</span></code></pre></div>
<pre><code>##  [1] 136.2321 137.6087 139.7882 140.1295 140.0936 139.6354 141.2500 143.7929
##  [9] 144.3251 143.6510</code></pre>
<p>Graficamos el comportamiento de los datos reales vs su prediccion y el pronostico</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="modelos-de-redes-neuronales-recurrentes-en-series-de-tiempo.html#cb4-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfcol =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb4-2"><a href="modelos-de-redes-neuronales-recurrentes-en-series-de-tiempo.html#cb4-2" tabindex="-1"></a></span>
<span id="cb4-3"><a href="modelos-de-redes-neuronales-recurrentes-en-series-de-tiempo.html#cb4-3" tabindex="-1"></a><span class="do">### Grafico train-test</span></span>
<span id="cb4-4"><a href="modelos-de-redes-neuronales-recurrentes-en-series-de-tiempo.html#cb4-4" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(outputs[<span class="sc">-</span>test])</span>
<span id="cb4-5"><a href="modelos-de-redes-neuronales-recurrentes-en-series-de-tiempo.html#cb4-5" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit, inputs[<span class="sc">-</span>test])</span>
<span id="cb4-6"><a href="modelos-de-redes-neuronales-recurrentes-en-series-de-tiempo.html#cb4-6" tabindex="-1"></a><span class="fu">plot</span>(y, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Prediccion RNN Elman AAPL&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Dia&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Precio cierre&quot;</span>, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb4-7"><a href="modelos-de-redes-neuronales-recurrentes-en-series-de-tiempo.html#cb4-7" tabindex="-1"></a><span class="fu">lines</span>(pred, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb4-8"><a href="modelos-de-redes-neuronales-recurrentes-en-series-de-tiempo.html#cb4-8" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Datos reales&quot;</span>, <span class="st">&quot;Predicciones&quot;</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">box.lwd =</span> <span class="dv">2</span>)</span>
<span id="cb4-9"><a href="modelos-de-redes-neuronales-recurrentes-en-series-de-tiempo.html#cb4-9" tabindex="-1"></a></span>
<span id="cb4-10"><a href="modelos-de-redes-neuronales-recurrentes-en-series-de-tiempo.html#cb4-10" tabindex="-1"></a><span class="do">### Grafico Pronostico</span></span>
<span id="cb4-11"><a href="modelos-de-redes-neuronales-recurrentes-en-series-de-tiempo.html#cb4-11" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>(tamano_total <span class="sc">+</span> <span class="fu">length</span>(valuesPred))</span>
<span id="cb4-12"><a href="modelos-de-redes-neuronales-recurrentes-en-series-de-tiempo.html#cb4-12" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(stock<span class="sc">$</span>close, valuesPred) </span>
<span id="cb4-13"><a href="modelos-de-redes-neuronales-recurrentes-en-series-de-tiempo.html#cb4-13" tabindex="-1"></a><span class="fu">plot</span>(x, y, <span class="at">main =</span> <span class="st">&quot;Pronostico RNN Elman AAPL&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Dia&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Precio cierre&quot;</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span>
<span id="cb4-14"><a href="modelos-de-redes-neuronales-recurrentes-en-series-de-tiempo.html#cb4-14" tabindex="-1"></a><span class="fu">lines</span>(x[<span class="dv">1</span><span class="sc">:</span>tamano_total], y[<span class="dv">1</span><span class="sc">:</span>tamano_total], <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb4-15"><a href="modelos-de-redes-neuronales-recurrentes-en-series-de-tiempo.html#cb4-15" tabindex="-1"></a><span class="fu">lines</span>(x[(tamano_total)<span class="sc">:</span><span class="fu">length</span>(x)], y[(tamano_total)<span class="sc">:</span><span class="fu">length</span>(x)], <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb4-16"><a href="modelos-de-redes-neuronales-recurrentes-en-series-de-tiempo.html#cb4-16" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Datos reales&quot;</span>, <span class="st">&quot;Pronostico&quot;</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">box.lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="stocks-predictions_files/figure-html/08-4-1.png" width="672" /></p>
</div>
<div id="modelo-de-jordan" class="section level2 hasAnchor" number="8.2">
<h2><span class="header-section-number">8.2</span> Modelo de Jordan<a href="modelos-de-redes-neuronales-recurrentes-en-series-de-tiempo.html#modelo-de-jordan" class="anchor-section" aria-label="Anchor link to header"></a></h2>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="modelo-prophet.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="referencias.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/ingadrianr/stocks_predictions/edit/main/08-Redes_Neuronales.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["stocks-predictions.pdf", "stocks-predictions.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
